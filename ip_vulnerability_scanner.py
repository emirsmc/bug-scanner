import asyncio
import json
import os
import socket
from datetime import datetime
from prettytable import PrettyTable

class VulnerabilityScanner:
    def __init__(self, targets):
        self.targets = targets
        self.vulnerabilities = []
        self.progress = 0

    async def scan_target(self, target):
        print(f"Scanning {target}...")
        await asyncio.sleep(1)  # Simulate scan time
        self.vulnerabilities.append((target, "Vulnerability found!"))

    async def async_scan(self):
        tasks = [self.scan_target(target) for target in self.targets]
        await asyncio.gather(*tasks)

    def start_scan(self):
        asyncio.run(self.async_scan())

    def report(self, format='json'):
        report_data = {'scan_date': datetime.utcnow().isoformat(), 'vulnerabilities': self.vulnerabilities}
        if format == 'json':
            return json.dumps(report_data, indent=4)
        elif format == 'html':
            report = "<html><body><h1>Vulnerability Report</h1><table border='1'>"
            for target, vulnerability in self.vulnerabilities:
                report += f"<tr><td>{target}</td><td>{vulnerability}</td></tr>"
            report += "</table></body></html>"
            return report

def ethical_notice():
    notice = "This tool is for educational purposes only. Use responsibly and with permission."
    print(notice)

if __name__ == '__main__':
    ethical_notice()
    targets = ['192.168.1.1', 'example.com']  # Replace with actual targets
    scanner = VulnerabilityScanner(targets)
    scanner.start_scan()
    json_report = scanner.report(format='json')
    html_report = scanner.report(format='html')

    # Save reports
    with open('report.json', 'w') as json_file:
        json_file.write(json_report)

    with open('report.html', 'w') as html_file:
        html_file.write(html_report)

    print("Scan complete. Reports generated.")